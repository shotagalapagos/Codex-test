<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>簡単アンケート（Q1とQ2のみ）</title>
    <style>
      /* 必要最低限のスタイルだけ（シンプル） */
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Noto Sans JP, sans-serif; margin: 24px; line-height: 1.6; }
      h1 { margin: 0 0 8px; font-size: 22px; }
      form { margin-top: 12px; max-width: 600px; }
      .q { padding: 14px 0; border-top: 1px solid #e5e5e5; }
      .q:first-of-type { border-top: none; padding-top: 0; }
      .q-title { display: block; font-weight: 600; margin-bottom: 8px; }
      .choices { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 6px; }
      .choices label { display: flex; align-items: center; gap: 8px; padding: 8px 10px; border: 1px solid #e5e5e5; border-radius: 10px; cursor: pointer; }
      .rating { display: inline-flex; gap: 6px; direction: rtl; }
      .rating input { position: absolute; left: -9999px; }
      .rating label { font-size: 26px; color: #ccc; cursor: pointer; }
      .rating input:checked ~ label, .rating label:hover, .rating label:hover ~ label { color: #f5b301; }
      button { padding: 10px 16px; border-radius: 10px; border: 1px solid #e5e5e5; background: #111; color: #fff; cursor: pointer; }
      small { color: #666; }
    </style>
  </head>
  <body>
    <h1>簡単アンケート</h1>
    <form id="survey" novalidate>
      <!-- Q1: どこで知ったか（必須） -->
      <section class="q">
        <label class="q-title">Q1. このサービスをどこで知りましたか？（必須）</label>
        <div class="choices">
          <label><input type="radio" name="discover" value="SNS" required /> SNS</label>
          <label><input type="radio" name="discover" value="検索" /> 検索</label>
          <label><input type="radio" name="discover" value="友人・同僚" /> 友人・同僚</label>
          <label><input type="radio" name="discover" value="イベント" /> イベント</label>
          <label><input type="radio" name="discover" value="その他" /> その他</label>
        </div>
      </section>

      <!-- Q2: Q1の内容に応じて質問文が変わる（必須） -->
      <section class="q" id="q2">
        <label class="q-title">Q2. <span id="q2TitleText">満足度を教えてください</span>（必須）</label>
        <div class="rating" role="radiogroup" aria-label="満足度">
          <input type="radio" id="star5" name="satisfaction" value="5" required />
          <label for="star5" title="とても満足">★</label>
          <input type="radio" id="star4" name="satisfaction" value="4" />
          <label for="star4" title="満足">★</label>
          <input type="radio" id="star3" name="satisfaction" value="3" />
          <label for="star3" title="普通">★</label>
          <input type="radio" id="star2" name="satisfaction" value="2" />
          <label for="star2" title="やや不満">★</label>
          <input type="radio" id="star1" name="satisfaction" value="1" />
          <label for="star1" title="不満">★</label>
        </div>
        <small id="q2Hint">★の数で評価してください</small>
      </section>

      <div class="q">
        <button type="submit">送信する</button>
      </div>
    </form>

    <script>
      // ——— できるだけシンプルな連動ロジック ———
      // 1) HTML要素を取得
      const form = document.getElementById('survey');
      const q1Radios = document.querySelectorAll('input[name="discover"]');
      const q2TitleText = document.getElementById('q2TitleText');
      const q2Hint = document.getElementById('q2Hint');
      const q2Radios = document.querySelectorAll('input[name="satisfaction"]');
      const q2Group = document.querySelector('.rating');

      // 2) Q1の値に応じて表示したいQ2の文言（表）
      const q2TextMap = {
        'SNS': 'SNSで見た情報は役に立ちましたか？',
        '検索': '検索結果の内容は分かりやすかったですか？',
        '友人・同僚': '紹介への満足度を教えてください',
        'イベント': 'イベントの内容に満足しましたか？',
        'その他': '全体的な満足度を教えてください',
        'default': '満足度を教えてください',
      };

      // 3) Q1が変わったらQ2の文言を更新
      function updateQ2ByQ1() {
        const selected = document.querySelector('input[name="discover"]:checked');
        const key = selected ? selected.value : 'default';
        q2TitleText.textContent = q2TextMap[key] || q2TextMap.default;
        q2Group.setAttribute('aria-label', q2TitleText.textContent);
        q2Hint.textContent = '★の数で評価してください';
        // Q1が変わったらQ2は選び直しにする
        q2Radios.forEach(r => r.checked = false);
      }

      q1Radios.forEach(r => r.addEventListener('change', updateQ2ByQ1));
      updateQ2ByQ1(); // 初期反映

      // 4) 送信ボタン（最小限）。バリデーションはブラウザに任せる。
      form.addEventListener('submit', (e) => {
        e.preventDefault();
        if (!form.checkValidity()) {
          form.reportValidity();
          return;
        }
        const discover = document.querySelector('input[name="discover"]:checked')?.value;
        const satisfaction = document.querySelector('input[name="satisfaction"]:checked')?.value;
        alert(`送信ありがとうございました\nQ1: ${discover}\nQ2: ${satisfaction} / 5`);
        form.reset();
        updateQ2ByQ1();
      });
    </script>
  </body>
</html>

